# Add Time in Range (TIR) to Blood Sugar Display

*Date: 2026-01-24 1100*

## Why

Time in Range (TIR) is a standard diabetes metric that shows the percentage of glucose readings within the target range (70-180 mg/dL) over a 24-hour period. Having TIR visible on the dashboard provides at-a-glance insight into glucose control quality without needing to check a phone app.

## How

Added TIR calculation and display to the blood sugar region:

1. **calculateTIR function**: Filters glucose history to last 24 hours and calculates percentage within 70-180 mg/dL
2. **Tiny font % character**: Added the percent sign to the 3x5 pixel font for legends
3. **measureTinyText helper**: Added function to calculate tiny text width for right-alignment
4. **Display positioning**: TIR shows in bottom right corner of sparkline chart, matching the style of existing 21h/3h labels

## Key Design Decisions

- **24-hour window**: Matches standard TIR calculation period used in diabetes management
- **Same styling as time labels**: Using veryDim color and tiny font keeps it unobtrusive
- **Right-aligned**: Positions opposite to the left-aligned hour labels for visual balance
- **Returns null for no data**: Gracefully handles cases with no recent readings

## What's Next

- Could add color coding (green for good TIR >70%, yellow for moderate, red for poor)
- Could add other standard metrics (Time Below Range, Time Above Range)
